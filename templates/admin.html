{% extends "layout.html" %}

{% block greeting %}
{{ name }}
{% endblock %}

{% block content %}
<script type='text/javascript'>
$(document).ready(function() {
    alert('pre-loading');
    getpeople();
    getgroups();
    alert('Starting JS');
    
    $('#people_list').change(function() {
        $('#person_attributes>input').val('');
        $.ajax({
            url: '/people/'+ $(this).val(),
            success: function(data) {
                $('#person_username').val(data.userName);
                $('#person_firstname').val(data.firstName);
                $('#person_lastname').val(data.lastName);
                $('#person_group').val(data.groupName);
                $('#person_manager').val(data.manager);
                $('#person_ismanager').val(data.isManager);
            }
        });
    });
    
    function getpeople(){
        $.ajax({
            url: '/people',
            success: function(data){
                data.foreach(function(person) {
                    $('#people_list').append('<option value="'+person.uid+'" data-username='+person.userName+'>'+person.firstName+'</option>');
                });
            },
            datatype: 'json'
        });
        alert('What People?');
    }
    
    function getgroups(){
        $.ajax({
            url: '/groups',
            success: function(data){
                data.foreach(function(group){
                    $('#group_list').append('<option value="'+group._id+'" > ' + group.name + '</option>');
                });
            },
            dataType: 'json'
        });
    }
    
    
</script>


<h1>Peedy-Pee Admin Page</h1>
<br>
<br>
<h2>Edit People</h2>
<hr>
<div id='person_div' class='clearfix'>
<select id=people_list size='10'>
{% for value in people_dict %}
<option value='{{ key }} '>{{ value.userName }}</option>
{% endfor %}
</select>
<form id="person_attributes" action='/admin_update_person' method="POST">
<label>Username: <input id="person_username" type="text" name="person_username"></label><br>
<label>First Name: <input id="person_firstname" type="text" name="person_firstname"></label><br>
<label>Last Name: <input id="person_lastname" type="text" name="person_lastname"></label><br>
<label>Group: <input id="person_group" type="text" name="person_group"></label><br>
<label>Manager: <input id="person_manager" type="text" name="person_manager"></label><br>
<label>isManager: <input type="checkbox" name="person_ismanager"></label><br><p>
<button id="person_save" class="right">Save Person</button><br>
<button id="view_person-pdp" class="right">View PDP</button>
</form>
</div>
<br><br>
<h2>Edit Group</h2>
<hr>
<div id="group_div" class='clearfix'>
<select id="group_list" size="10"></select>
<form id='group_attributes' action='/admin_update_group' method='POST'>
<label>Group Name: <input id="group_name" type="text" name="group_name"></label><br>
<button id='save_group' class='right'>Save Group</button>
</form>
</div>

{% endblock %}
